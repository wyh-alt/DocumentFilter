# 文件筛选工具

这是一个基于Python和PyQt6开发的文件筛选工具，主要用于根据文件命名相关性在不同文件夹之间筛选和管理文件。

## 功能特点

1. 多种匹配方式：
   - 根据源目录匹配提取：在源目录和目标目录间查找匹配的文件
   - 根据文本匹配提取：通过关键字在目标目录中筛选文件

2. 匹配依据选项：
   - 完整文件名匹配
   - ID前缀匹配（支持纯数字、纯英文、英文数字混合的ID格式）

3. 文件批量操作：
   - 复制选中文件到输出目录
   - 移动选中文件到输出目录
   - 删除选中文件

4. 现代化界面：
   - 友好的用户界面，表格形式显示结果
   - 支持拖放目录
   - 文件操作进度显示
   - 高亮显示匹配的关键字

## 新增功能：批量重命名

- 新增"批量重命名"页面卡片，支持对指定目录下所有文件进行批量重命名。
- 支持的重命名类型：
  - 添加自定义前缀
  - 添加自定义后缀
  - 删除指定字段
  - 替换指定字段
  - 按升序编号（支持多种编号格式）
  - **Excel替换命名**（新增功能）
- 支持重命名预览，执行前可查看所有新旧文件名对照。
- 支持"撤回重命名"按钮，可一键撤销最近一次批量重命名操作。

### Excel替换命名功能

- **自动生成Excel文件**：选择重命名目录后，程序自动读取所有文件名并生成Excel表格。
- **Excel编辑**：点击"打开表格"按钮，使用系统默认Excel程序编辑文件重命名规则。
- **表格结构**：Excel文件包含两列："源文件名"和"重命名"，用户只需编辑"重命名"列。
- **使用流程**：
  1. 选择重命名目录
  2. 选择"Excel替换命名"方式
  3. 点击"打开表格"编辑重命名规则
  4. 如果新名称不包含文件扩展名，将自动保持原文件扩展名
  5. 保存Excel文件并关闭
  6. 返回程序点击"预览重命名"查看效果
  7. 确认无误后点击"执行重命名"
- **自动清理**：程序退出或选择新目录时自动清除Excel缓存文件。

## 安装

1. 确保已安装Python 3.6或更高版本

2. 安装依赖项：
   ```
   pip install -r requirements.txt
   ```

## 使用方法

1. 运行程序：
   ```
   python file_selector.py
   ```

2. 在界面中选择源目录、目标目录和输出目录：
   - 可以通过"浏览..."按钮选择
   - 也可以直接将文件夹拖放到对应位置

3. 选择匹配方式：
   - 根据源目录匹配提取：选择匹配依据（完整文件名/ID前缀）和是否匹配文件格式
   - 根据文本匹配提取：输入检索文本（支持多行或分号分隔）

4. 点击"查找匹配文件"按钮进行文件匹配

5. 在表格中选择需要处理的文件（可使用全选/取消全选/反选按钮）

6. 点击相应的操作按钮（复制/移动/删除）执行操作

## 匹配方式说明

1. **根据源目录匹配提取**：
   - 完整文件名：匹配源目录和目标目录中完全相同的文件名
   - ID前缀：提取文件名开头的字母数字序列作为匹配依据（如"ABC123-文件.txt"与"ABC123_其他文件.doc"）

2. **根据文本匹配提取**：
   - 在目标目录中查找包含指定文本的文件
   - 支持多个关键字（换行或分号分隔）
   - 提供两种匹配模式：
     - 完全匹配：只匹配文件名（不含扩展名）与输入文本完全相同的文件
     - 检索匹配：匹配文件名中包含输入文本的文件（如输入"12345"时，"12345.txt"和"a12345b.doc"都会被匹配）

## 批量文件提取界面优化

- 目录选择区域（源目录、目标目录、输出目录）的文本框宽度现在会自适应拉伸，始终填满剩余空间。
- "浏览..."按钮始终靠右，整体布局更美观、实用。

--- 